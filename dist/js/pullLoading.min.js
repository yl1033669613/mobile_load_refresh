!function(l,t){"use strict";function o(t){return!(!t||void 0===l||t!==l&&!t.nodeType)}function i(t){this._init(t)}i.prototype={constructor:i,_init:function(t){this.dte=100,this.isPullUp=!1,this.isPullDown=!1,this.pullUpLoading=!1,this.pullDownLoading=!1,this.isPullUpEnd=!1,this.currY=0,this.option=function(t,l,o){for(var i in l)!l.hasOwnProperty(i)||t.hasOwnProperty(i)&&!o||(t[i]=l[i]);return t}({scrollEle:null,scrollEleHeight:"300px",refreshEl:null,pullUpBefore:null,pullUpIn:null,pullUpEnd:null,pullDown:null,pullUp:null},t,!0),this._checkOption()&&(this._css(this.option.scrollEle,{overflow:"scroll",webkitOverflowScrolling:"touch",height:this.option.scrollEleHeight}),this.isPullUp&&(this._show(this.option.pullUpBefore),this._hide(this.option.pullUpIn),this._hide(this.option.pullUpEnd)),this.isPullDown&&this._css(this.option.refreshEl,{transition:"transform .1s"}),this._scrollHandle(),this._touchHandle())},_checkOption:function(){if(!o(this.option.scrollEle))throw new Error("scrollEle不存在或者不是一个可操作的dom实例");if(t=this.option.scrollEle,/HTML|BODY/.test(t.tagName))throw new Error("scrollEle不能是HTML或者BODY节点");var t;if("function"!=typeof this.option.pullDown&&"function"!=typeof this.option.pullUp)return!1;if("function"==typeof this.option.pullDown){if(!o(this.option.refreshEl))throw new Error("refreshEl不存在或者不是一个可操作的dom实例");this.isPullDown=!0}if("function"==typeof this.option.pullUp){if(!o(this.option.pullUpBefore))throw new Error("pullUpBefore不存在或者不是一个可操作的dom实例");if(!o(this.option.pullUpIn))throw new Error("pullUpIn不存在或者不是一个可操作的dom实例");if(!o(this.option.pullUpEnd))throw new Error("pullUpEnd不存在或者不是一个可操作的dom实例");this.isPullUp=!0}return!0},_touchHandle:function(){var i=this,n=0,s=0;i.isPullDown&&(s=i.option.refreshEl.offsetHeight),i.option.scrollEle.addEventListener("touchstart",function(t){i.currY=t.changedTouches[0].clientY}),i.option.scrollEle.addEventListener("touchmove",function(t){if(0==i._getScrollTop()&&(i._getScrollHeight()==i._getClientHeight()&&t.changedTouches[0].clientY-i.currY<0&&(t.preventDefault(),t.changedTouches[0].clientY-i.currY<-i.dte&&i._pullUp()),0<t.changedTouches[0].clientY-i.currY&&i.isPullDown&&!i.pullUpLoading)){if(t.preventDefault(),t.changedTouches[0].clientY-i.currY<i.dte&&!i.pullDownLoading){var l=t.changedTouches[0].clientY-n-i.currY,o=(n+=l)/(i.dte/s);s<o&&(o=s),i._css(i.option.refreshEl,{transition:"transform 0s",transform:"translate(0, "+o+"px)"})}t.changedTouches[0].clientY-i.currY>i.dte&&(i._css(i.option.refreshEl,{transform:"translate(0, "+s+"px)"}),i._pullDown())}}),i.option.scrollEle.addEventListener("touchend",function(t){0==i._getScrollTop()&&0<t.changedTouches[0].clientY-i.currY&&t.changedTouches[0].clientY-i.currY<i.dte&&i._css(i.option.refreshEl,{transition:"transform .2s",transform:"translate(0, 0)"})})},_scrollHandle:function(){var l=this;l.option.scrollEle.addEventListener("scroll",function(t){l._getScrollTop()+l._getClientHeight()==l._getScrollHeight()&&l._pullUp()})},_pullUp:function(){!this.isPullUp||this.pullUpLoading||this.isPullUpEnd||this.pullDownLoading||(this.pullUpLoading=!0,this._hide(this.option.pullUpBefore),this._show(this.option.pullUpIn),this.option.pullUp&&this.option.pullUp(this))},_pullDown:function(){this.isPullDown&&!this.pullDownLoading&&(this.pullDownLoading=!0,this.option.pullDown&&this.option.pullDown(this))},_getScrollTop:function(t){return this.option.scrollEle.scrollTop},_getClientHeight:function(){return this.option.scrollEle.clientHeight},_getScrollHeight:function(){return this.option.scrollEle.scrollHeight},_hide:function(t){t.style.display="none"},_show:function(t){t.style.display="block"},_css:function(t,l){for(var o in l){var i=o.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});-1!=i.indexOf("webkit")&&(i="-"+i),t.style[i]=l[o]}},stopPull:function(){!this.isPullUpEnd&&this.isPullUp&&(this._show(this.option.pullUpBefore),this._hide(this.option.pullUpIn)),this.isPullDown&&this._css(this.option.refreshEl,{transition:"transform .2s",transform:"translate(0, 0)"}),this.pullUpLoading=!1,this.pullDownLoading=!1},pullUpEnd:function(t){this.isPullUp&&((this.isPullUpEnd=t)?(this._show(this.option.pullUpEnd),this._hide(this.option.pullUpIn),this._hide(this.option.pullUpBefore)):(this._show(this.option.pullUpBefore),this._hide(this.option.pullUpIn),this._hide(this.option.pullUpEnd)))}},!("PullLoading"in l)&&(l.PullLoading=i)}(window);