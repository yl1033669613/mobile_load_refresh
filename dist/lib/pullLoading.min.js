!function(l,t){"use strict";var s="",o="";function n(t){return!(!t||void 0===l||t!==l&&!t.nodeType)}function e(t){return l.document.querySelector(t)}function i(t){return t.style.display="none",t}function r(t){return t.style.display="block",t}function h(t,l){for(var i in l)t.style[i]=l[i];return t}function p(t){this._init(t)}p.prototype={constructor:p,_init:function(t){if(this.containerEle=null,this.scrollEle=null,this.refreshEl=null,this.pullUpBeforeEl=null,this.pullUpInEl=null,this.pullUpEndEl=null,this.isPullUp=!1,this.isPullDown=!1,this.pullUpLoading=!1,this.pullDownLoading=!1,this.isPullUpEnd=!1,this.currY=0,this.startY=0,this.pullDownY=0,this.contClientHeight=0,this.option=function(t,l,i){for(var n in l)!l.hasOwnProperty(n)||t.hasOwnProperty(n)&&!i||(t[n]=l[n]);return t}({threshold:80,container:"",pullDown:null,pullUp:null},t,!0),this._checkOption()){if(h(this.containerEle,{overflow:"hidden"}),h(this.scrollEle,{overflow:"scroll",webkitOverflowScrolling:"touch"}),this.contClientHeight=this.scrollEle.clientHeight,this.isPullUp&&(r(this.pullUpBeforeEl),i(this.pullUpInEl),i(this.pullUpInEl)),this.isPullDown){r(this.refreshEl),this.refreshLoadingEleHeight=this.refreshEl.offsetHeight;var l={top:-this.refreshLoadingEleHeight+"px"};l[o]="transform .1s",h(this.refreshEl,l)}this._initEvent()}},_checkOption:function(){var t,l=this.option,i=function(){for(var t="",l="",i=document.createElement("div").style,n=["transform","webkitTransform"],s=["transition","webkitTransition"],o=0,e=n.length;o<e;o++)n[o]in i&&!t&&(t=n[o]),s[o]in i&&!l&&(l=s[o]);return{transform:t,transition:l}}();s=i.transform,o=i.transition;try{if(!s||!o)throw new Error("浏览器不支持本插件");if(this.containerEle=e(l.container),!n(this.containerEle))throw new Error(l.container+" 实例未找到");if(t=this.containerEle,/HTML|BODY/.test(t.tagName))throw new Error(l.container+" 不能是HTML或者BODY节点");if(this.scrollEle=e(this.option.container+" .pl-wrapper"),"function"!=typeof l.pullDown&&"function"!=typeof l.pullUp)return!1;if("function"==typeof l.pullDown){if(this.refreshEl=e(l.container+" .pl-down"),!n(this.refreshEl))throw new Error("请添加下拉刷新loading");this.isPullDown=!0}if("function"==typeof l.pullUp){if(this.pullUpBeforeEl=e(l.container+" .pl-up-before"),this.pullUpInEl=e(l.container+" .pl-up-in"),this.pullUpEndEl=e(l.container+" .pl-up-end"),!n(this.pullUpBeforeEl))throw new Error("请添加上拉加载前提示");if(!n(this.pullUpInEl))throw new Error("请添加上拉加载中提示");if(!n(this.pullUpEndEl))throw new Error("请添加上拉加载已加载全部内容提示");this.isPullUp=!0}}catch(t){return console.error(t),!1}return!0},_initEvent:function(){this.scrollEle.addEventListener("touchstart",this._touchstartHandle.bind(this)),this.scrollEle.addEventListener("touchmove",this._touchmoveHandle.bind(this)),this.scrollEle.addEventListener("touchend",this._touchendHandle.bind(this)),this.scrollEle.addEventListener("scroll",this._scrollHandle.bind(this))},_touchstartHandle:function(t){this.startY=this.currY=t.changedTouches[0].clientY,this.pullDownY=0},_touchmoveHandle:function(t){var l=t.changedTouches[0].clientY;if(0==this.scrollEle.scrollTop&&(this.isPullUp&&this.scrollEle.scrollHeight<=this.contClientHeight&&l-this.startY<0&&t.preventDefault(),this.isPullDown&&0<=l-this.startY&&!this.pullUpLoading&&!this.pullDownLoading)){t.preventDefault(),this.pullDownY=l-this.currY+this.pullDownY,this.currY=l;var i=this.pullDownY/(this.option.threshold/this.refreshLoadingEleHeight);i>=this.refreshLoadingEleHeight&&(i=this.refreshLoadingEleHeight);var n={};n[o]="transform 0s",n[s]="translate(0, "+i+"px)",h(this.refreshEl,n)}},_touchendHandle:function(t){if(!this.pullUpLoading&&!this.pullDownLoading){var l=t.changedTouches[0].clientY;if(0==this.scrollEle.scrollTop){var i;if(this.isPullDown)if(l-this.startY>=this.option.threshold)(i={})[s]="translate(0, "+this.refreshLoadingEleHeight+"px)",h(this.refreshEl,i),this._pullDown();else(i={})[o]="transform .2s",i[s]="translate(0, 0)",h(this.refreshEl,i);this.isPullUp&&this.scrollEle.scrollHeight<=this.contClientHeight&&l-this.startY<=-this.option.threshold&&this._pullUp()}}},_scrollHandle:function(t){this.isPullUp&&this.scrollEle.scrollTop+this.contClientHeight==this.scrollEle.scrollHeight&&this._pullUp()},_pullUp:function(){this.isPullUpEnd||this.pullDownLoading||this.pullUpLoading||(this.pullUpLoading=!0,i(this.pullUpBeforeEl),r(this.pullUpInEl),this.option.pullUp&&this.option.pullUp(this))},_pullDown:function(){this.pullDownLoading||this.pullUpLoading||(this.pullDownLoading=!0,this.pullUpEnd(!1),this.option.pullDown&&this.option.pullDown(this))},stopPull:function(){if(!this.isPullUpEnd&&this.isPullUp&&(r(this.pullUpBeforeEl),i(this.pullUpInEl)),this.isPullDown){var t={};t[o]="transform .2s",t[s]="translate(0, 0)",h(this.refreshEl,t)}return this.pullUpLoading=!1,this.pullDownLoading=!1,this},pullUpEnd:function(t){if(this.isPullUp)return(this.isPullUpEnd=t)?(r(this.pullUpEndEl),i(this.pullUpInEl),i(this.pullUpBeforeEl)):(r(this.pullUpBeforeEl),i(this.pullUpInEl),i(this.pullUpEndEl)),this.isPullUpEnd}},!("PullLoading"in l)&&(l.PullLoading=p)}(window);